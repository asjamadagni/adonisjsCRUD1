"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const User_1 = __importDefault(global[Symbol.for('ioc.use')]("App/Models/User"));
class AuthController {
    async login({ request, auth }) {
        const email = request.input("email");
        const password = request.input("password");
        const token = await auth.use("api").attempt(email, password, {
            expiresIn: "10 days",
        });
        return token.toJSON();
    }
    async register({ request, auth }) {
        const email = request.input("email");
        const password = request.input("password");
        const name = request.input("name");
        const user = new User_1.default();
        user.email = email;
        user.password = password;
        user.name = name;
        await user.save();
        const token = await auth.use("api").login(user, {
            expiresIn: "10 days",
        });
        return token.toJSON();
    }
}
exports.default = AuthController;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0aENvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJBdXRoQ29udHJvbGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBLGlGQUFtQztBQUNuQyxNQUFxQixjQUFjO0lBQzFCLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUF1QjtRQUN2RCxNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3JDLE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFM0MsTUFBTSxLQUFLLEdBQUcsTUFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFO1lBQzNELFNBQVMsRUFBRSxTQUFTO1NBQ3JCLENBQUMsQ0FBQztRQUNILE9BQU8sS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ3hCLENBQUM7SUFFTSxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBdUI7UUFDMUQsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNyQyxNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzNDLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFNbkMsTUFBTSxJQUFJLEdBQUcsSUFBSSxjQUFJLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNuQixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztRQUN6QixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixNQUFNLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUVsQixNQUFNLEtBQUssR0FBRyxNQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRTtZQUM5QyxTQUFTLEVBQUUsU0FBUztTQUNyQixDQUFDLENBQUM7UUFFSCxPQUFPLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUN4QixDQUFDO0NBQ0Y7QUFoQ0QsaUNBZ0NDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSHR0cENvbnRleHRDb250cmFjdCB9IGZyb20gXCJAaW9jOkFkb25pcy9Db3JlL0h0dHBDb250ZXh0XCI7XG5pbXBvcnQgVXNlciBmcm9tIFwiQXBwL01vZGVscy9Vc2VyXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBdXRoQ29udHJvbGxlciB7XG4gIHB1YmxpYyBhc3luYyBsb2dpbih7IHJlcXVlc3QsIGF1dGggfTogSHR0cENvbnRleHRDb250cmFjdCkge1xuICAgIGNvbnN0IGVtYWlsID0gcmVxdWVzdC5pbnB1dChcImVtYWlsXCIpO1xuICAgIGNvbnN0IHBhc3N3b3JkID0gcmVxdWVzdC5pbnB1dChcInBhc3N3b3JkXCIpO1xuXG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBhdXRoLnVzZShcImFwaVwiKS5hdHRlbXB0KGVtYWlsLCBwYXNzd29yZCwge1xuICAgICAgZXhwaXJlc0luOiBcIjEwIGRheXNcIixcbiAgICB9KTtcbiAgICByZXR1cm4gdG9rZW4udG9KU09OKCk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgcmVnaXN0ZXIoeyByZXF1ZXN0LCBhdXRoIH06IEh0dHBDb250ZXh0Q29udHJhY3QpIHtcbiAgICBjb25zdCBlbWFpbCA9IHJlcXVlc3QuaW5wdXQoXCJlbWFpbFwiKTtcbiAgICBjb25zdCBwYXNzd29yZCA9IHJlcXVlc3QuaW5wdXQoXCJwYXNzd29yZFwiKTtcbiAgICBjb25zdCBuYW1lID0gcmVxdWVzdC5pbnB1dChcIm5hbWVcIik7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgdXNlclxuICAgICAqL1xuXG4gICAgY29uc3QgdXNlciA9IG5ldyBVc2VyKCk7XG4gICAgdXNlci5lbWFpbCA9IGVtYWlsO1xuICAgIHVzZXIucGFzc3dvcmQgPSBwYXNzd29yZDtcbiAgICB1c2VyLm5hbWUgPSBuYW1lO1xuICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuXG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBhdXRoLnVzZShcImFwaVwiKS5sb2dpbih1c2VyLCB7XG4gICAgICBleHBpcmVzSW46IFwiMTAgZGF5c1wiLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRva2VuLnRvSlNPTigpO1xuICB9XG59XG4iXX0=